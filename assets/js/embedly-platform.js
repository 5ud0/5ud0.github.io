!function(){var d=function c(l,k,j){function i(m,g){if(!k[m]){if(!l[m]){var f="function"==typeof d&&d;if(!g&&f){return f(m,!0)}if(b){return b(m,!0)}throw new Error("Cannot find module '"+m+"'")}var e=k[m]={exports:{}};l[m][0].call(e.exports,function(n){var h=l[m][1][n];return i(h?h:n)},e,e.exports,c,l,k,j)}return k[m].exports}for(var b="function"==typeof d&&d,a=0;a<j.length;a++){i(j[a])}return i}({conf:[function(f,e,g){e.exports=f("d0R7L1")},{}],d0R7L1:[function(f,e,g){!function(i){i.EMB_DEBUG=!1,i.EMB_HTTPS="http:"!==window.location.protocol?!0:!1,i.EMB_ORIGIN=(i.EMB_HTTPS?"https":"http")+"://cdn.embedly.com",i.EMB_ORIGIN_BASE=i.EMB_ORIGIN+"/",i.EMB_ASSET_VERSION="3a0db3eb",i.EMB_FRAME_SRC=i.EMB_ORIGIN+"/widgets/",i.EMB_SECURE_FRAME_SRC="https://cdn.embedly.com/widgets/",i.EMB_POST_MESSAGE=!!window.postMessage,i.EMB_PROGRESS=!0,i.EMB_APP_API="https://app.embed.ly",i.EMB_API_KEY="fd92ebbc52fc43fb98f69e50e7893c13";var h=window.location.pathname.split(".")[0].split("/");i.EMB_GROUP=h[h.length-1].toLowerCase(),i.PAGE_PROGRESS_DOMAINS=[]}("undefined"==typeof e?this.conf={}:e.exports)},{}],3:[function(h,g,l){var k=h("./utils.js"),j=h("./browser.js"),i=function(){return this instanceof i?void this.init():new i};i.prototype.init=function(){this.data={},this.dead=!1},i.prototype.event=function(b){return k.isObject(b)?(k.assert(b.event,"a.event no event"),k.assert(b.listener,"a.event no listener"),[b.event,b.listener].join(".")):b},i.prototype.add=function(m,f,p,o){p=p===!0?!0:!1,m=this.event(m);var n={func:f,one:p,ctx:o};return this.data.hasOwnProperty(m)?this.data[m].push(n):this.data[m]=[n],this},i.prototype.on=function(f,e,m){return this.add(f,e,!1,m)},i.prototype.off=function(f,e){if(!this.data.hasOwnProperty(f)){return this}var m=k.reduce(this.data[f],function(b,n){return k.isNone(e)||n.func!==e?k.isNone(e)?b:(b.push(n),b):b},[]);return 0===m.length?delete this.data[f]:this.data[f]=m,this},i.prototype.one=function(f,e,m){return this.add(f,e,!0,m)},i.prototype.get=function(m,f,o,n){k.isFunction(f)&&(o=f,f={},o&&(n=o)),f||(f={}),k.assert(o),f.hasOwnProperty("listener")||(f.listener="l"+k.getUUID()),this.one({event:m,listener:f.listener},o,n),this.notify(m,f)},i.prototype.notify=function(){if(this.dead){return !1}var m=Array.prototype.slice.call(arguments,0);if(0===m.length){return this}var e=this.event(m.splice(0,1)[0]);if(!this.data.hasOwnProperty(e)){return this}var p,o=[],n=[];return k.each(this.data[e],function(b){n.push(b),b.one===!1&&o.push(b)}),0===o.length?delete this.data[e]:this.data[e]=o,k.each(n,function(b){try{p=k.isNone(b.ctx)?this:b.ctx,b.func.apply(p,m)}catch(a){j.console.error(e,m,a)}},this),this},i.prototype.listeners=function(b){return k.reduce(this.data,function(a,n,m){var f=m.split(".");return 2===f.length&&f[0]===b&&a.push(f[1]),a},[])},i.prototype.clear=function(){this.dead=!0,this.data={}},g.exports=i},{"./browser.js":5,"./utils.js":30}],4:[function(i,h,n){var m=i("./utils.js"),l=i("./browser.js"),k=i("conf"),j={};j.random=function(b){return Math.floor(Math.random()*b)},j.safeCreateQuery=function(f){var e=m.map(f,function(o,g){return g+"="+("urls"===g?o:encodeURIComponent(o))});return e.sort(),e.join("&")},j.Keeper=function(f,e){this.init(f,e)},j.Keeper.prototype={init:function(f,e){this.urls=f,this.count=0,this.results={},this.callback=e},each:function(f){if(this.results[f.original_url]=f,this.count++,this.count===this.urls.length){var e=m.map(this.urls,function(b){return this.results[b]},this);this.callback(e)}return this}},j.ajax=function(f,e,o){var g=new XMLHttpRequest;if("withCredentials" in g){g.open("GET",f,!0),o===!0&&(g.withCredentials=!0),g.setRequestHeader("Accept","application/json"),g.onreadystatechange=function(){4===g.readyState&&(200===g.status?e&&e(JSON.parse(g.responseText)):e&&e({type:"error"}))}}else{if("undefined"==typeof XDomainRequest){return e({type:"error"}),!1}g=new XDomainRequest,g.open("GET",f),g.onload=function(){e&&e(JSON.parse(g.responseText))},g.onerror=function(){e({type:"error"})},g.onprogress=function(){}}g.send(null)},j.API=function(b){this.init(b)},j.API.prototype.init=function(b){m.isString(b)?this.key=b:m.isNone(b)||(this.key=b.key),this.key=this.key?this.key:k.EMB_API_KEY,this.protocol="http:"===window.location.protocol?"http:":"https:"},j.API.prototype._buildUrl=function(f,e){if(m.isNone(this.key)){return null}var g=this.protocol+"//api-cdn.embed.ly/"+f;return e=e?e:{},e.key=this.key,g+"?"+j.safeCreateQuery(e)},j.API.prototype._data=function(g,e,t,s){if(l.console.log(g,e,t,s),m.isNone(s)&&m.isFunction(t)&&(s=t,t={}),m.isNone(s)){return !1}if(m.isString(e)){t.url=e;var r=this._buildUrl(g,t);return j.ajax(r,function(b){b.url=e,s(b)}),!0}if(m.isArray(e)){if(0===e.length){return !1}var q=new j.Keeper(e,s),p=m.batch(e,10),o=function(u,f){return function(a){m.each(f,function(v,x){var w=a[x];w.original_url=v,u.each(w)})}};return m.each(p,function(a){t.urls=m.map(a,function(b){return encodeURIComponent(b)}).join(",");var f=this._buildUrl(g,t);j.ajax(f,o(q,a))},this),!0}return s({type:"error"}),!1},j.API.prototype.oembed=function(f,e,g){return this._data("1/oembed",f,e,g)},j.API.prototype.extract=function(f,e,g){return this._data("1/extract",f,e,g)},j.API.prototype.event=function(g,f){var q="api-"+j.random(10)+".embed.ly",p=this.protocol+"//"+q+"/1/e",o=p+"?"+j.safeCreateQuery(g);j.ajax(o,f)},j.Display=function(){},j.Display.prototype._buildUrl=function(g,f,r){var q={key:k.EMB_API_KEY,url:f},p=m.extend(q,m.isNone(r)?{}:r),o="://i-cdn.embed.ly/1/display"+("display"===g?"":"/"+g);return(k.EMB_HTTPS?"https":"http")+o+"?"+j.safeCreateQuery(p)},j.Display.prototype.display=function(f,e){return this._buildUrl("display",f,e)},j.Display.prototype.crop=function(f,e){return this._buildUrl("crop",f,e)},j.Display.prototype.resize=function(f,e){return this._buildUrl("resize",f,e)},j.api=function(b){return new j.API(b)},j.display=function(){return new j.Display},h.exports=j},{"./browser.js":5,"./utils.js":30,conf:"d0R7L1"}],5:[function(j,i,p){var o=j("./utils.js"),n=j("./dom.js"),m=j("./urlparse.js"),l=j("conf"),k={};k.supports={_test:function(q){var h=["Webkit","Moz","O","ms","Khtml"],u=document.createElement("div"),t=q.charAt(0).toUpperCase()+q.substr(1),s=[q];o.each(h,function(b){s.push(b+t)});for(var r=0;r<s.length;r++){if(""===u.style[s[r]]){return !0}}return !1},postMessage:function(){return !!window.postMessage},boxShadow:function(){return k.supports._test("boxShadow")},borderRadius:function(){return k.supports._test("borderRadius")},touch:function(){return !!("ontouchstart" in window)},svg:function(){return !!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},mediaQuery:function(){return !("undefined"==typeof window.matchMedia&&"undefined"==typeof window.msMatchMedia)},rgba:function(){var f=document.createElement("div"),e=f.style.color;try{f.style.color="rgba(1,5,13,0.44)"}catch(g){}return f.style.color!==e},cors:function(){if("undefined"==typeof XMLHttpRequest){return !1}var b=new XMLHttpRequest;return"withCredentials" in b?!0:"undefined"!=typeof XDomainRequest?!0:!1},flash:function(){if("undefined"!=typeof navigator.plugins&&0!==navigator.plugins.length){return !!navigator.plugins["Shockwave Flash"]}try{return !!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(b){return !1}},canvas:function(){var b=document.createElement("canvas");return !(!b.getContext||!b.getContext("2d"))}},k.detect=function(){var b=function(f,e){e?n.addClass(document.body,f):n.addClass(document.body,"no-"+f)};b("touch",k.supports.touch()),b("boxshadow",k.supports.boxShadow()),b("borderradius",k.supports.borderRadius()),b("rgba",k.supports.rgba()),b("mediaquery",k.supports.mediaQuery())},k.console={_log:function(f,e){if((l.EMB_DEBUG||window.EMB_DEBUG)&&!o.isNone(window.console)&&window.console&&window.console[f]){if(window.console[f].apply){window.console[f].apply(window.console,e)}else{var g=Array.prototype.join.call(e,", ");window.console[f](g)}}},log:function(){this._log("log",arguments)},error:function(){this._log("error",arguments)}},k.open=function(q,h,w,v,u,t){if(o.isNone(u)||o.isNone(t)){var s=k.window.center(w,v);u=s.top,t=s.left}var r=window.open(q,h,"scrollbars=no, resizable=1, width="+w+", height="+v+", top="+u+", left="+t);window.focus&&r.focus()},k.cookie={set:function(h,g,t,s){var r="";if(t){var q=new Date;q.setTime(q.getTime()+24*t*60*60*1000),r="; expires="+q.toGMTString()}document.cookie=h+"="+g+r+"; path=/"+(s?"; secure":"")},get:function(g){for(var f=g+"=",r=document.cookie.split(";"),q=0;q<r.length;q++){for(var h=r[q];" "===h.charAt(0);){h=h.substring(1,h.length)}if(0===h.indexOf(f)){return h.substring(f.length,h.length)}}return null},del:function(b){k.cookie.set(b,"",-1)}},k.window={innerHeight:function(){return o.isNone(window.innerHeight)?document.documentElement.clientHeight:window.innerHeight},innerWidth:function(){return o.isNone(window.innerWidth)?document.documentElement.clientWidth:window.innerWidth},scrollY:function(){return o.isNone(window.pageYOffset)?(document.documentElement||document.body.parentNode||document.body).scrollTop:window.pageYOffset},center:function(r,q){var x=void 0!==window.screenLeft?window.screenLeft:screen.left,w=void 0!==window.screenTop?window.screenTop:screen.top,v=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,u=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,t=v/2-r/2+x,s=u/2-q/2+w;return{left:t,top:s}}},k.location={hash:function(){var b=window.location.href.split("#");return 2===b.length?b[1]:""},params:function(){return o.extend({},m.parseQuery(document.location.search),m.parseQuery(k.location.hash()))}},k.mobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},k.isIE=function(){return/msie|trident/i.test(navigator.userAgent)},k.isFirefox=function(){return/firefox/i.test(navigator.userAgent)},k.isPhantom=function(){return/phantomjs/i.test(navigator.userAgent)},k.isSafari=function(){return/safari/i.test(navigator.userAgent)},k.language=function(){return window.navigator.userLanguage||window.navigator.language},k.animateScroll=function(y,x){var w,v,u=k.window.scrollY(),t=y-u,s=(new Date).getTime(),r=!1;x=x?x:500;var q=Math.round(t/x*10),h=function(a){return a>y};0>q&&(h=function(a){return y>a});var e=function(){clearInterval(w),k.console.log("duration",(new Date).getTime()-s),n.detachEvent("scroll",v)};w=setInterval(function(){return u+=q,h(u)?(e(),!1):(window.scrollTo(0,u),void (r=!0))},10),v=function(){r&&u!==k.window.scrollY()&&e()},n.addEvent("scroll",v)},i.exports=k},{"./dom.js":8,"./urlparse.js":29,"./utils.js":30,conf:"d0R7L1"}],6:[function(h,g,l){var k=!1,j=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,i=function(){};i.extend=function(m){function e(){!k&&this.init&&this.init.apply(this,arguments)}var p=this.prototype;k=!0;var o=new this;k=!1;for(var n in m){o[n]="function"==typeof m[n]&&"function"==typeof p[n]&&j.test(m[n])?function(q,f){return function(){var b=this._super;this._super=p[q];var a=f.apply(this,arguments);return this._super=b,a}}(n,m[n]):m[n]}return e.prototype=o,e.prototype.constructor=e,e.extend=arguments.callee,e},g.exports=i},{}],7:[function(h,g,l){var k=h("./iframes/comms.js").one,j=h("./utils.js"),i={started:!1,instance:null};i.EVENTS=["xcomm.options.access","xcomm.media.recommend","xcomm.card.recommend","xcomm.user.set","xcomm.user.get","xcomm.user.remove","xcomm.log.event","xcomm.page.progress"],i.clear=function(){i.instance&&(i.instance.remove(),i.instance=null),i.started=!1},i.connect=function(f,e){if(!f||i.started){return !1}i.started=!0;var m=k(f,e);return i.instance=m,j.each(i.EVENTS,function(a){m.on(a,function(n){var b=a;n.listener&&(b={event:a,listener:n.listener}),f.notify(b,n)}),f.on(a,function(b){m.send(a,b)})}),m.on("xcomm.ready",function(a){f.notify("xcomm.ready",a)}),m},g.exports=i},{"./iframes/comms.js":14,"./utils.js":30}],8:[function(h,g,l){var k=h("./utils.js"),j=h("conf"),i={};i.toArray=function(b){return k.map(b,function(e){return e})},i.all=function(f){var e=[];return document.querySelectorAll?i.toArray(document.querySelectorAll(f)):e},i.one=function(f,e){var m=i.all(f,e);return 0===m.length?null:m[0]},i.create=function(m,f,p,o){if(!m||!k.isString(m)){return null}k.isString(f)&&k.isNone(p)&&(p=f,f={});var n;return n=o?document.createElementNS("http://www.w3.org/2000/svg",m):document.createElement(m),k.each(f,function(q,e){n.setAttribute(e,q)}),p&&i.text(n,p),n},i.set=function(m,f,o){if(!m||!k.isString(m)){return null}k.isString(f)&&k.isNone(o)&&(o=f,f={});var n=i.one(m);return n?(k.each(f,function(p,e){n.setAttribute(e,p)}),k.isNone(o)||i.text(n,o),n):null},i.replace=function(f,e){k.assert(k.isElement(f),"replace requires an element to be replaced"),k.assert(k.isElement(e),"replace requires an element to replace with."),f.parentNode.replaceChild(e,f)},i.remove=function(b){return k.isElement(b)&&k.isElement(b.parentNode)?void b.parentNode.removeChild(b):!1},i.hide=function(b){return k.isString(b)&&(b=i.one(b)),k.isElement(b)&&(b.style.display="none"),b},i.show=function(f,e){return k.isString(f)&&(f=i.one(f)),k.isElement(f)&&(f.style.display=e?"inline-block":"block"),f},i.svg=function(f,e,m){return i.create(f,e,m,"http://www.w3.org/2000/svg")},i.children=function(f,e){return k.isElement(f)?k.reduce(f.childNodes,function(b,m){if(k.isElement(m)){if(!k.isNone(e)){if(m.namespaceURI&&"http://www.w3.org/2000/svg"===m.namespaceURI){if(m.nodeName!==e){return b}}else{if(e.toUpperCase()!==m.nodeName){return b}}}b.push(m)}return b},[]):[]},i.child=function(f,e){var m=i.children(f,e);return 0!==m.length?m[0]:null},i.text=function(f,e){if(k.isString(f)&&(f=i.one(f)),!f||!k.isElement(f)){return null}if(k.isNone(e)){return f.innerText||f.textContent}var m=void 0===f.textContent?"innerText":"textContent";f[m]=e},i.hasClass=function(f,e){if(k.isString(f)&&(f=i.one(f)),!k.isElement(f)||!k.isString(e)||!e){return !1}var m=f.getAttribute("class");return k.isNone(m)?!1:(" "+m+" ").indexOf(" "+e+" ")>-1?!0:!1},i.addClass=function(m,f){if(k.isString(m)&&(m=i.one(m)),!k.isElement(m)||!k.isString(f)||!f){return !1}if(i.hasClass(m,f)){return !1}var p=m.getAttribute("class");if(k.isNone(p)){return m.setAttribute("class",f),!0}var o=p.split(" "),n=[];return k.map(o,function(q){var e=k.trim(q);""!==e&&n.push(e)}),n.push(f),m.setAttribute("class",n.join(" ")),!0},i.removeClass=function(m,f){if(k.isString(m)&&(m=i.one(m)),!k.isElement(m)||!k.isString(f)||!f){return !1}var p=m.getAttribute("class");if(k.isNone(p)){return !1}var o=!1,n=k.reduce(p.split(" "),function(b,q){var e=k.trim(q);return e?e===f?(o=!0,b):(b.push(e),b):b},[]);return m.setAttribute("class",n.join(" ")),o},i.data=function(m,f,o){k.assert(m&&k.isElement(m),"dom.data needs an element."),k.assert(f&&k.isString(f),"dom.data needs an attr.");var n=k.camelCase(f,1);return k.isNone(o)?k.isNone(m.dataset)?m.getAttribute("data-"+f):k.isNone(m.dataset[n])?null:m.dataset[n]:void (k.isNone(m.dataset)?m.setAttribute("data-"+f,o):m.dataset[n]=o)},i.attrize=function(b){return b&&k.isObject(b)?k.map(b,function(f,e){return e+'="'+f+'"'}).sort().join(" "):""},i.event=function(f){var e=k.extend({},f||window.event);return e.target||(e.target=e.srcElement||document),3===e.target.nodeType&&(e.target=e.target.parentNode),!f.metaKey&&f.ctrlKey&&(e.metaKey=e.ctrlKey),e.stop=function(){f.preventDefault?f.preventDefault():f.returnValue=!1},e.pageX||e.pageY||!e.clientX&&!e.clientY||(e.pageX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.pageY=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),e},i.addEvent=function(f,e,m){k.isNone(f)||(f.addEventListener?f.addEventListener(e,m,!1):f.attachEvent?f.attachEvent("on"+e,m):f["on"+e]=m)},i.detachEvent=function(f,e,m){k.isNone(f)||(f.removeEventListener?f.removeEventListener(e,m,!1):f.detachEvent?f.detachEvent("on"+e,m):f["on"+e]=null)},i.trigger=function(f,e){k.assert(k.contains(["click"],e),"Not a valid event");var m;f.dispatchEvent?(m=document.createEvent("MouseEvents"),m.initEvent(e,!0,!0),f.dispatchEvent(m,!0)):(m=document.createEventObject(),f.fireEvent("on"+e,m))},i.rect=function(f){try{return f.getBoundingClientRect()}catch(e){}return !1},j.EMB_DEBUG===!0&&(window.dom=i),g.exports=i},{"./utils.js":30,conf:"d0R7L1"}],9:[function(j,i,p){var o=j("./utils.js"),n=j("./swap.js"),m=j("./dom.js"),l=j("./mutations.js"),k={timeout:null,hub:null,selectors:{cards:[{selector:".embedly-card"}],button:[".embedly-button"],slideshow:[".embedly-slideshow"]},analytics:null,_queue:[]};k.add={},k.add.cards=function(f){if(o.isString(f)){if(".embedly-card"===f){return !1}k.selectors.cards.push({selector:f})}else{if(!o.isElement(f)&&o.isObject(f)){if(!f.selector&&!f.types){return !1}var e={};if(o.isArray(f.types)&&f.types.length>0&&(e.types=f.types),f.selector){e.selector=f.selector,k.selectors.cards.push(e)}else{var g=k.selectors.cards.reduce(function(q,h){return".embedly-card"===h.selector?h:q},{});if(!g){return !1}g.types=e.types}}}k.look()},k.add.button=function(b){o.isString(b)&&(k.selectors.button.push(b),k.look())},k.select=function(f,e){return"."===f.substr(0,1)?m.hasClass(e,f.substr(1))?!0:!1:o.contains(m.all(f),e)?!0:!1},k.each=function(f){var e,h;if("A"===f.nodeName||"BLOCKQUOTE"===f.nodeName){for(e=0;e<k.selectors.cards.length;e++){if(h=k.selectors.cards[e],k.select(h.selector,f)){return f._em_opts=h,{name:"card",node:f}}}}if("A"===f.nodeName){for(e=0;e<k.selectors.button.length;e++){if(k.select(k.selectors.button[e],f)){return{name:"button",node:f}}}}if("DIV"===f.nodeName){for(e=0;e<k.selectors.slideshow.length;e++){if(k.select(k.selectors.slideshow[e],f)){return{name:"slideshow",node:f}}}}if("IFRAME"===f.nodeName){if("embedly-embed"===f.className){return{name:"iframe",node:f}}if(f.src&&/\/\/cdn\.embedly\.com\/widgets\/media\.html/.test(f.src)){return{name:"iframe",node:f}}if(null!==k.analytics&&k.analytics.replace){var g=n.replace(f,k.analytics);if(null!==g){return{name:"iframe",node:g}}}}return null},k.release=function(){var f=k._queue;k._queue=[],f=o.reduce(f,function(h,g){return o.contains(h,g)?h:g.className&&"embd-"===g.className.substr(0,5)?h:(h.push(g),h)},[]);var e=o.reduce(f,function(h,g){var q=k.each(g);return q&&h[q.name+"s"].push(q.node),h},{cards:[],buttons:[],slideshows:[],iframes:[]});k.hub.notify("found",e)},k.queue=function(b){clearTimeout(k.timeout),k._queue.push(b),k.timeout=setTimeout(function(){k.release()},50)},k.look=function(){o.each(k.selectors.cards,function(b){o.each(m.all(b.selector),function(e){k.queue(e)})}),o.each(k.selectors.button,function(b){o.each(m.all(b),function(e){k.queue(e)})}),o.each(k.selectors.slideshow,function(b){o.each(m.all(b),function(e){k.queue(e)})}),o.each(m.all("iframe"),function(b){k.queue(b)}),k.hub&&k.hub.notify("look.done")},k.stop=function(){l.stop()},k.connect=function(b){k.hub=b,b.on("mutation.insert.a",k.queue),b.on("mutation.insert.blockquote",k.queue),b.on("mutation.insert.iframe",k.queue),l.connect(b),k.look()},i.exports=k},{"./dom.js":8,"./mutations.js":21,"./swap.js":27,"./utils.js":30}],10:[function(f,e,g){e.exports={cards:f("./cards.js"),button:f("./button.js"),modal:f("./modal.js"),slideshow:f("./slideshow.js"),comms:f("./comms.js"),connect:f("./base.js").connect}},{"./base.js":11,"./button.js":12,"./cards.js":13,"./comms.js":14,"./modal.js":15,"./slideshow.js":16}],11:[function(t,s,r){var q=t("../utils.js"),p=t("../dom.js"),o=t("../a.js"),n=t("../browser.js"),m=t("../urlparse.js"),l=t("conf"),k={};k.connect=function(z,y,x){if(!y||!q.isElement(y)){return !1}var w={sid:z,elem:y},v=m.getOrigin(y.src?y.src:document.location.toString()),u=new o,h=[],g=!1,f=y.src;w.on=function(j,i,A){u.on(j,i,A)},w.one=function(j,i,A){u.one(j,i,A)},w.off=function(j,i){u.off(j,i)},w.send=function(j,i,B){if(q.isNone(i)&&(i={}),q.isString(i)&&(i={msg:i}),i.method=j,g===!1&&!B){return n.console.log("frame.queue",i),h.push(i),!1}if(w.sid&&(i.sid=w.sid),n.console.log("frame.send",i),w.__tunnel){w.__tunnel.send(i)}else{if(w.elem.contentWindow&&w.elem.contentWindow.postMessage){var A=JSON.stringify(i);w.elem.contentWindow.postMessage(A,null===v?"*":v)}}},w.ready=function(){g||(n.console.log("frame.ready",w.name),g=!0,q.each(h,function(b){w.send(b.method,b)}))},w.resize=function(b){b.width&&w.elem.setAttribute("width",b.width),b.height&&w.elem.setAttribute("height",b.height)},w.remove=function(){p.remove(w.elem),w.__hub.clear(),w.__tunnel&&w.__tunnel.clear(),w._remove&&w._remove()},u.on("message",function(b){"resize"===b.method&&w.resize&&w.resize(b),b.event&&b.listener?u.notify({event:b.event,listener:b.listener},b):b.method&&u.notify(b.method,b)});var e=function(j,i){if(j.origin===v||null===v||"about:"===j.origin){if(!i.src&&!i.sid&&!i.listener){return !1}if(w.sid&&i.sid!==w.sid){return !1}if(i.src&&i.src!==f){return !1}n.console.log("frame.message",i),u.notify("message",i)}};return x.on("window.message",e),w._remove=function(){x.off("window.message",e)},w.__hub=u,w},k.rendering=function(b){return"1"===p.data(b,"rendering")?!0:(p.data(b,"rendering","1"),!1)},k.create=function(z,y,x,w,v){var u=q.getUUID();x.sid=u;var j=q.extend({},w);x.sandbox===!1&&(j.src=l.EMB_FRAME_SRC+z+".html#sid="+u),x.url&&(j.id="emb_"+q.hash(x.url)),j["class"]="embedly-"+z;var i=p.create("iframe",j);q.each(v,function(g,f){i.style[f]=g});var e=k.connect(u,i,y);return e.__appended=function(){},x.sandbox===!1?e:(e.__appended=function(){var a=i.contentWindow.document,F=decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E");a.open(),a.write(F),a.close();var E=a.getElementsByTagName("head")[0],D=l.EMB_ORIGIN_BASE+"js/all."+l.EMB_ASSET_VERSION+".js",C=l.EMB_ORIGIN_BASE+"css/all."+l.EMB_ASSET_VERSION+".css",B=a.createElement("script");B.type="text/javascript",B.src=D;var A=a.createElement("link");A.type="text/css",A.rel="stylesheet",A.href=C,e.__hub.notify(z+".load",i,a),E.appendChild(A),a.body.appendChild(B)},e)},s.exports=k},{"../a.js":3,"../browser.js":5,"../dom.js":8,"../urlparse.js":29,"../utils.js":30,conf:"d0R7L1"}],12:[function(r,q,p){var o=r("../utils.js"),n=r("../browser.js"),m=r("../dom.js"),l=r("./base.js"),k=r("../tunnels.js"),j={name:"button",attrs:{frameborder:"0",scrolling:"no",allowtransparency:"true",height:"20",width:"80"},styles:{border:"none"}};j.one=function(h,f){if(!o.isElement(h)){return null}if(l.rendering(h)){return null}var t=m.data(h,"url");o.isNone(t)&&(t=document.location.toString());var s,i={url:t};o.each(["theme","target","lang"],function(a){s=m.data(h,a),o.isNone(s)||(i[a]=s)});var g=n.window.center(635,500);i.left=g.left,i.top=g.top;var e=l.create("button",f,i,j.attrs,j.styles);return e.one("button.load",function(v){var u=function(y,x){return function(a){y.__tunnel=new k.Tunnel(y.__hub),a.create(x,y.__tunnel)}},w=u(e,i);v.contentWindow.buttons?w(v.contentWindow.buttons):v.contentWindow.onButtonsReady=w}),m.replace(h,e.elem),e.__appended(),e.on("button.click",function(){n.window.innerWidth()<=768||n.mobile()?window.location="http://embed.ly/code?url="+encodeURIComponent(i.url):f.notify("modal.create",i)}),e.on("button.ready",function(){e.ready()}),e},q.exports=j},{"../browser.js":5,"../dom.js":8,"../tunnels.js":28,"../utils.js":30,"./base.js":11}],13:[function(B,A,z){var y=B("../api.js"),x=B("../utils.js"),w=B("../dom.js"),v=B("../urlparse.js"),u=B("../browser.js"),t=B("../keeper.js"),s=B("./base.js"),r=B("../share.js"),q=B("../tunnels.js"),p={attrs:{frameborder:"0",scrolling:"no",allowtransparency:"true",allowfullscreen:"true"},styles:{width:"1px",height:"0px",border:"none",position:"absolute",visibility:"hidden"},extractless:/https:\/\/\w+\.pinterest\.com\/.*/,sandboxless:[{re:/https?:\/\/\w+\.facebook\.com\/.*/},{re:/https?:\/\/twitter\.com\/.*/,test:function(){return u.isFirefox()}}]};p.isPercent=function(b){return/\%/i.test(b)},p.cleanWidth=function(f){f=x.trim(f);var e=/(\d+)px/i.exec(f);return e&&(f=e[1]),f},p.sandbox=function(f){var e,g;for(e=0;e<p.sandboxless.length;e++){if(g=p.sandboxless[e],g.re.test(f)){return x.isFunction(g.test)?!g.test(f):!1}}return !0},p.options=function(H){if(!x.isElement(H)||!x.isElement(H.parentNode)){return null}var G={sandbox:!0};if(x.each(["type","via","chrome","image","description","key","align","embed","controls","analytics","lang","width","referrer","theme","recommend"],function(b){var a=w.data(H,"card-"+b);x.isNone(a)||(G[b]=a)}),x.each(["recommend-1","recommend-2","recommend-3"],function(b){var a=w.data(H,"card-"+b);x.isNone(a)||(G.hasOwnProperty("recommendations")?G.recommendations.push(a):G.recommendations=[a])}),"BLOCKQUOTE"===H.nodeName){var F,E=w.child(H,"h4"),D=w.child(H,"p");if(x.isNone(E)){if(!D){return !1}var C=H.getElementsByTagName("a");if(0===C.length){return !1}F=C[C.length-1],G.url=F.getAttribute("href")}else{F=w.child(E,"a"),G.url=F.getAttribute("href"),G.title=w.text(F),x.isNone(D)?G.description="0":G.description=w.text(D)}}else{"A"===H.nodeName&&(G.url=H.getAttribute("href"))}var m,g,f;if(x.each(document.getElementsByTagName("meta"),function(b){f=[b.getAttribute("name"),b.getAttribute("property")],x.contains(f,"twitter:site")?g=b.getAttribute("content"):x.contains(f,"twitter:creator")&&(m=b.getAttribute("content"))}),m?G.twitter_via=m:g&&(G.twitter_via=g),!G.url){return null}var e=v.parse(G.url);return e.valid()?(G.url=e.url,G.sandbox=p.sandbox(G.url),G.referrer||(G.referrer=document.URL),G.width&&(G.width=p.cleanWidth(G.width)),/thescore\.com/.test(G.referrer)&&(G.key="900b122ee8ee43f79b2240c831f24429"),G):null};var o=function(f,e,h,g){this.init(f,e,h,g)};o.prototype.init=function(F,E,D,C){if(this.elem=E,this.options=D,!D.url){return this.error=!0,this.frame=null,!1}this.error=!1,this.frame=p.build(E,D,F),this._done=C;var n=new t,m=n.callback();this.frame.one("card.load",function(h,g){m({iframe:h,doc:g})}),this._extract=n.callback(),this.extract=x.bind(function(b){return this.extracted?!1:(this.extracted=!0,void this._extract(b))},this),D.embed&&(this.media=n.callback());var i=E.parentNode;i&&i.offsetWidth&&(i.offsetWidth>600?this.frame.elem.style.width="600px":this.frame.elem.style.width=i.offsetWidth+"px");var f=w.create("div",{"class":"embedly-card"}),e=w.create("div",{"class":"embedly-card-hug"});f.appendChild(e),e.appendChild(this.frame.elem),i.insertBefore(f,E),this.frame.__appended(),n.wait(this.done,this)},o.prototype.done=function(i){var h=i[0].iframe,n=i[0].doc,m=i[1],l={};if(3===i.length&&(l=i[2].media),!this.frame.elem.parentNode){return !1}if(this.options.sandbox===!1){this.frame.ready(),this.frame.send("card.create",{options:this.options,extract:m,media:l})}else{var k=function(g,e,D,C){return function(b){C.__tunnel=new q.Tunnel(C.__hub),b.create(n.body,{options:e,extract:D,media:l,tunnel:C.__tunnel})}},j=k(h,this.options,m,this.frame);h.contentWindow.cards?j(h.contentWindow.cards):h.contentWindow.onCardsReady=j}this.frame.options=this.options,this.frame.extract=m,this._done(this.frame)},p.fetch=function(G,F,E,D){E=x.extend({},E?E:{}),E.protocol=window.location.protocol,E=x.map(F,function(b){return E.override===!0?x.extend({},p.options(b),E):x.extend({},E,p.options(b))});var C=new t,n=[];E=x.reduce(E,function(h,g,b){var a=new o(G,F[b],g,C.callback());return p.extractless.test(g.url)?a.extract({}):a.error||h.push(g),n.push(a),h},[]);var m=x.reduce(E,function(g,f){return g.push(f.url),f.embed&&g.push(f.embed),g},[]);if(!m.length){return x.isFunction(D)&&D(x.map(n,function(b){return b.frame})),x.map(n,function(b){return b.frame})}var i={card:1,v:2,youtube_showinfo:0},e=window.location.protocol;return E.protocol&&(e=E.protocol),e=e.split(":")[0],x.contains(["http","https"],e)||(e="https"),i.scheme=e,y.api().extract(m,i,function(b){x.each(b,function(f){x.each(n,function(a){a.options.url===f.original_url?a.extract(f):a.options.embed===f.original_url&&a.media(f)})})}),C.wait(function(b){D(b)}),x.map(n,function(b){return b.frame})},p.build=function(f,e,h){var g=s.create("card",h,e,p.attrs,p.styles);return u.isFirefox()&&(g.elem.style.visibility="visible",g.elem.style.height="1px"),g.on("card.repeat",function(j){var i={url:j.url,via:document.location.toString()};x.each(["image","embed","title","description","lang"],function(a){j.hasOwnProperty(a)&&(i[a]=j[a])}),h.notify("modal.create",i)}),g.on("card.ready",function(){g.ready()}),g.on("card.rendered",function(a){if(g.url=a.url,g.type=a.type,"error"===a.name){return g.__hub.notify("card.error",f),g.remove(),!1}if(f._em_opts){var j=x.extend({},f._em_opts);if(delete f._em_opts,x.isArray(j.types)&&j.types.length>0&&!x.contains(j.types,a.type)){return g.__hub.notify("card.error",f),g.remove(),!1}}g.rendered=!0,!g.options.twitter_via&&a.defaultTwitterVia&&(g.options.twitter_via=a.defaultTwitterVia);var i=g.elem.parentNode;g.elem.style.display="block",g.elem.style.margin="0",g.elem.style.padding="0",g.elem.style.visibility="visible",g.elem.style.position="relative",a.height?g.elem.height=a.height:g.elem.height="300",a.width?p.isPercent(a.width)?(i.style.width=a.width,g.elem.width="100%"):g.elem.width=a.width:g.elem.width="600",i.style.width=g.elem.width+"px",i.style.padding="0",i.style.position="relative",i.style.maxWidth="100%","left"===a.align?i.style.margin="5px 0":"right"===a.align?i.style.margin="5px 0 5px auto":i.style.margin="5px auto",g.elem.style.width=null,g.elem.style.height=null,g.elem.style.maxWidth="100%",g.elem.style.minWidth="200px",w.remove(f),"error"!==a.type&&(h.notify("card.rendered",g.elem,g),a.controls&&r.card(g))}),g.one("card.error",function(b){h.notify("card.error",b)}),g.on("resize",function(){h.notify("card.resize",g.elem,g)}),g.on("log.event",function(b){h.notify("log.event",b)}),g.on("pinterest.log",function(){h.notify("pinterest.log")}),g.on("card.player.ready",function(){h.notify("card.player.ready",g)}),g.on("card.recommend.shown",function(b){h.notify("recommend.shown",g.elem,b)}),g},p.multi=function(f,e,h,g){return f=x.reduce(f,function(j,i){return s.rendering(i)?j:(j.push(i),j)},[]),p.fetch(h,f,e,function(b){x.isFunction(g)&&g(b)})},p.one=function(g,e,j,i){if(s.rendering(g)){return null}var h=p.fetch(j,[g],e,function(b){x.isFunction(i)&&i(b[0])});return h[0]},A.exports=p},{"../api.js":4,"../browser.js":5,"../dom.js":8,"../keeper.js":18,"../share.js":26,"../tunnels.js":28,"../urlparse.js":29,"../utils.js":30,"./base.js":11}],14:[function(r,q,p){var o=r("../utils.js"),n=r("../dom.js"),m=r("../urlparse.js"),l=r("./base.js"),k=r("conf"),j={attrs:{frameborder:"0",allowtransparency:"true"},styles:{border:"none",position:"absolute",top:"-9999em",width:"10px",height:"10px"}};j.one=function(g,e){var s=o.getUUID();o.assert(e.name),e=o.extend({sid:s},e?e:{});var i=o.extend({},j.attrs);i.id="emb_xcomm",i["class"]="embedly-xcomm",i.src=k.EMB_SECURE_FRAME_SRC+"xcomm.html#"+m.createQuery(e);var h=n.create("iframe",i);o.each(j.styles,function(u,t){h.style[t]=u});var f=l.connect(s,h,g);return f.on("xcomm.ready",function(){f.ready()}),document.body.appendChild(h),f},q.exports=j},{"../dom.js":8,"../urlparse.js":29,"../utils.js":30,"./base.js":11,conf:"d0R7L1"}],15:[function(r,q,p){var o=r("../utils.js"),n=r("../dom.js"),m=r("../browser.js"),l=r("./base.js"),k=r("../tunnels.js"),j={name:"modal",attrs:{frameborder:"0",allowtransparency:"true"},styles:{border:"none",position:"fixed",top:"0",left:"0",zIndex:"2147483647"}};j.one=function(f,e){if(o.isNone(f)&&(f={url:document.location.toString()}),o.isNone(f.url)&&(f.url=document.location.toString()),f.protocol=window.location.protocol,"window"===f.target){return m.open("http://cdn.embedly.com/widgets/embed?url="+encodeURIComponent(f.url),"Embed Code",635,500),!1}f.t="card";var g=l.create("modal",e,f,j.attrs,j.styles);return g.on("modal.load",function(a){var i=function(t,s){return function(b){t.__tunnel=new k.Tunnel(t.__hub),b.create(s,t.__tunnel)}},h=i(g,f);a.contentWindow.modals?h(a.contentWindow.modals):a.contentWindow.onModalsReady=h}),g.elem.style.width=m.window.innerWidth()+"px",g.elem.style.height=m.window.innerHeight()+"px",n.addEvent(window,"resize",function(){g.elem.style.width=m.window.innerWidth()+"px",g.elem.style.height=m.window.innerHeight()+"px"}),g.on("modal.close",function(){document.body.removeChild(g.elem)}),g.on("modal.ready",function(){g.ready()}),g.one("modal.copy",function(){e.notify("modal.copy",f)}),document.body.appendChild(g.elem),g.__appended(),g},q.exports=j},{"../browser.js":5,"../dom.js":8,"../tunnels.js":28,"../utils.js":30,"./base.js":11}],16:[function(t,s,r){var q=t("../utils.js"),p=t("../api.js"),o=t("../dom.js"),n=t("../keeper.js"),m=t("./base.js"),l=t("../tunnels.js"),k={name:"slideshow",attrs:{frameborder:"0",scrolling:"no",allowtransparency:"true",allowfullscreen:"true"},styles:{width:"1px",height:"0px",border:"none",position:"absolute",visibility:"hidden"},opts:["schema","lang","width","align"]};k.options=function(f,e){if(!q.isElement(f)||!q.isElement(f.parentNode)){return null}var g=q.reduce(k.opts,function(b,h){return e.hasOwnProperty(h)&&(b[h]=e[h]),b},e.options?e.options:{});return q.reduce(k.opts,function(a,i){var h=o.data(f,"slideshow-"+i);return q.isNone(h)||(a[i]=h),a},g)},k.urls=function(f,e){return q.isArray(e.urls)&&e.urls.length>0?e.urls:q.reduce(o.children(f,"blockquote"),function(h,g){if("BLOCKQUOTE"===g.nodeName){var j=o.child(g,"h4");if(!q.isNone(j)){var i=o.child(j,"a");q.isNone(i)||h.push(i.href)}}return h},[])},k.fetch=function(f,e){var g={card:1,v:1};p.api().extract(f,g,function(b){e(b)})},k.build=function(j,i,z){var y=i[0].iframe,x=i[0].doc,w=i[1],v=function(f,e,g){return function(a){f.__tunnel=new l.Tunnel(f.__hub),a.create(x.body,{options:e,extract:g,tunnel:f.__tunnel})}},u=v(z,j,w);y.contentWindow.slideshows?u(y.contentWindow.slideshows):y.contentWindow.onSlideshowsReady=u},k.one=function(y,x,w){if(!q.isElement(y)){return null}if(x=x?x:{},m.rendering(y)){return null}var v=k.options(y,x),u=k.urls(y,x);if(null===v||0===u.length){return null}var j=m.create("slideshow",w,v,k.attrs,k.styles),h=new n,g=h.callback(),f=h.callback();return h.wait(function(b){k.build(v,b,j)}),j.on("slideshow.load",function(i,e){g({iframe:i,doc:e})}),k.fetch(u,f),y.parentNode.insertBefore(j.elem,y),j.on("slideshow.ready",function(){j.ready()}),j.on("slideshow.rendered",function(a){return j.ready(),"error"===a.name?(j.remove(),j.__hub.notify("slideshow.error",y),!1):(j.rendered=!0,j.elem.style.display="block",j.elem.style.margin="10px auto",j.elem.style.visibility="visible",j.elem.style.position="relative",j.elem.width="700",a.height?j.elem.height=a.height:j.elem.height="500",a.width?j.elem.width=a.width:j.elem.width="700",j.elem.style.width=null,j.elem.style.height=null,j.elem.style.maxWidth="99%",j.elem.style.minWidth="300px",void o.remove(y))}),j.on("log.event",function(b){w.notify("log.event",b)}),j.__appended(),j},s.exports=k},{"../api.js":4,"../dom.js":8,"../keeper.js":18,"../tunnels.js":28,"../utils.js":30,"./base.js":11}],17:[function(h,g,l){var k=h("./utils.js"),j=h("./class.js"),i={senders:[],integrations:["google"]};i.Sender=j.extend({init:function(){this.sent=[]},event:function(f,e,m){return k.contains(this.sent,e)?!1:(this.sent.push(e),void this.send(f,e,m))},send:function(){}}),i.GoogleAnalytics=i.Sender.extend({isValid:function(){return window.ga&&k.isFunction(window.ga)},send:function(f,e,m){window.ga("send","event","Embedly > "+f,e,m)}}),i.integrations={ga:i.GoogleAnalytics},i.send=function(f,e,m){k.each(i.senders,function(a){a.isValid()&&a.event(f,e,m)}),i.hub&&i.hub.notify("analytics.event",f,e,m)},i.player=function(b){b.on("play",function(){i.send("Video","Play",b.url)}),b.on("timeupdate",function(a){if(a.seconds&&a.duration&&k.isNumber(a.seconds)&&k.isNumber(a.duration)){var e=parseInt(a.seconds/a.duration*4,10);e&&e>0&&5>e&&i.send("Video",k.fmt("{n}% Watched",{n:(25*e).toString()}),b.url)}}),b.on("ended",function(){i.send("Video","100% Watched",b.url)})},i.event=function(f,e,m){return f&&e&&m&&"click"===e?(k.contains(["facebook","twitter","pinterest","repeat"],f)&&(e=f,f="social"),"article-full"===f&&(f="article"),k.contains(["video","image","rich","article","product","social","recommend"],f)?(f=k.capitalize(f),e=k.capitalize(e),void i.send(f,e,m)):!1):!1},i.configure=function(b){b&&k.isArray(b)||(b=[]),i.senders=[],k.each(b,function(f){if(i.integrations.hasOwnProperty(f)){var e=i.integrations[f];i.senders.push(new e)}})},i.connect=function(b){b.on("media.player",i.player),k.each([i.GoogleAnalytics],function(e){i.senders.push(new e)}),i.hub=b,b.on("log.event",function(f){if(f&&f.a&&"click"===f.a){if("recommend"===f.c&&f.l){var e=f.l.split("|");3===e.length&&i.event(f.c,f.a,e.slice(1).join(" "))}else{i.event(f.c,f.a,f.u)}}})},g.exports=i},{"./class.js":6,"./utils.js":30}],18:[function(g,f,j){var i=g("./utils.js"),h=function(){this.init()};h.prototype.init=function(){this.len=0,this.count=0,this.results={},this.finished=!1,this.started=!1},h.prototype.callback=function(){var b=this.len;return this.len++,i.bind(function(a){this.each(b,a)},this)},h.prototype.done=function(){if(!this.started){return !1}if(this.finished){return !0}if(this.count===this.len){this.finished=!0;for(var k=[],e=0;e<this.len;e++){k.push(this.results[e])}return this.func.call(this.ctx,k),!0}},h.prototype.each=function(k,e){this.results[k]=e,this.count++,this.done()},h.prototype.wait=function(k,e){this.func=k,this.ctx=e?e:null,this.started=!0,this.done()},f.exports=h},{"./utils.js":30}],19:[function(j,i,p){var o=j("../utils.js"),n=j("../urlparse.js"),m=j("../browser.js"),l=j("../comms.js"),k={hub:null,timeout:null,connected:!1,connecting:!1,COOKIE_NAME:"em_cdn_uid",sid:o.getUUID(),_queue:[]};k.getUID=function(){var f=m.cookie.get(k.COOKIE_NAME);if(o.isNone(f)){return k.setUID()}var e=n.parseQuery(decodeURIComponent(f));if(!e.u||!e.t){return k.setUID()}var q;try{q=parseInt(e.t,10)}catch(h){return k.setUID()}return 32!==e.u.length?k.setUID():o.getTimestamp()-q>15552000000?k.setUID(e.u):e.u},k.setUID=function(f){var e={u:o.isNone(f)?o.getUUID():f,t:o.getTimestamp()},g=encodeURIComponent(n.createQuery(e));return m.cookie.set(k.COOKIE_NAME,g,365),g=m.cookie.get(k.COOKIE_NAME),o.isNone(g)?0:(e=n.parseQuery(decodeURIComponent(g)),e.u)},k.uid=k.getUID(),k.release=function(){var b=k._queue;k._queue=[],m.console.log("log.release",b),k.hub.notify("xcomm.log.event",{events:b})},k.queue=function(b){clearTimeout(k.timeout),k._queue.push(b),k.comms()&&(k.timeout=setTimeout(function(){k.release()},50))},k.event=function(f){var e={uid:k.uid,sid:k.sid,t:o.getTimestamp()};window.self===window.top?(e.r=document.location.toString(),e.rr=document.referrer):e.r=document.referrer,o.assert(f.g),o.assert(f.c),o.assert(f.a),e=o.extend({},e,f),k.queue(e)},k.comms=function(){return k.connected?!0:k.hub?k.connecting?!1:(k.connecting=!0,k.hub.one("xcomm.ready",function(){k.connected=!0,k.release()}),void l.connect(k.hub,{name:k.name})):!1},k.connect=function(f,e){k.name=e,f.on("log.event",function(b){k.event(b)}),k.hub=f},i.exports=k},{"../browser.js":5,"../comms.js":7,"../urlparse.js":29,"../utils.js":30}],20:[function(i,h,n){var m=i("./browser.js"),l=i("./utils.js"),k=i("./dom.js"),j={_data:null};j.COOKIE_NAME="em_p_uid",j.format=function(b){return b&&l.isObject(b)?l.map(b,function(f,e){return e+":"+f}).sort().join("|"):null},j.parse=function(f){if(!f){return null}var e;return l.reduce(f.split("|"),function(b,g){return null===b?null:(e=g.split(":"),2!==e.length?null:(b[e[0]]=e[1],b))},{})},j.timestamp=function(f){var e;try{e=parseInt(f,10)}catch(g){return !1}return e},j.get=function(){var f=m.cookie.get(j.COOKIE_NAME);if(l.isNone(f)){return j.set()}var e=j.parse(f),g=j.timestamp(e.t);return g===!1?j.set():l.getTimestamp()-g>15552000000?j.set({u:e.u,l:e.l}):e},j.set=function(f){var e={u:l.getUUID(),t:l.getTimestamp(),l:0};f&&(e=l.extend(e,f));var g=j.format(e);return m.cookie.set(j.COOKIE_NAME,g,365,"https:"===window.location.protocol),g=m.cookie.get(j.COOKIE_NAME),l.isNone(g)?null:j.parse(g)},j.update=function(f){var e=j.get();return e?(e=l.extend(e,f),j.set(e)):!1},j.data=function(){if(j._data){return j._data}var f={mt:l.getTimestamp(),mr:document.referrer,msw:m.window.innerWidth(),msh:m.window.innerHeight()},e=j.get();return e?(f.muu=e.u,f.mut=e.t,f.mul=e.l):f.muu=0,j._data=f,j.update({l:l.getTimestamp()}),j._data},j.send=function(f,e){if(!e||!l.isElement(e.elem)){return !1}var o=l.extend(j.data(),{}),g=k.rect(e.elem);g&&(o.mft=g.top,o.mfl=g.left,o.mfw=g.width,o.mfh=g.height),e.send(f,o)},h.exports=j},{"./browser.js":5,"./dom.js":8,"./utils.js":30}],21:[function(h,g,l){var k=h("./dom.js"),j=h("./utils"),i={_event:null,_observer:null};i.nodeNames=["iframe","a","blockquote"],i.html=function(){var b=document.getElementsByTagName("html");return 0===b.length?null:b[0]},i.recurse=function(f){var e=[];return j.isElement(f)&&e.push(f),j.reduce(f.childNodes,function(n,m){return j.isElement(m)?n.concat(i.recurse(m)):n},e)},i.observer=function(f){var e=i.html();if(null===e){return !1}if(!window.MutationObserver){return !1}i._observer=new window.MutationObserver(function(a){j.each(a,function(n){if("childList"===n.type&&n.addedNodes){var o=Array.prototype.slice.call(n.addedNodes);j.each(o,function(p){j.each(i.recurse(p),function(q){q.nodeName&&j.contains(i.nodeNames,q.nodeName.toLowerCase())&&f.notify("mutation.insert."+q.nodeName.toLowerCase(),q)})})}})});var m={childList:!0,subtree:!0};return i._observer.observe(e,m),!0},i.events=function(f){var e=i.html();return null===e?!1:(i._event=function(a){j.each(i.recurse(a.target),function(m){m.nodeName&&j.contains(i.nodeNames,m.nodeName.toLowerCase())&&f.notify("mutation.insert."+m.nodeName.toLowerCase(),m)})},k.addEvent(e,"DOMNodeInserted",i._event),!0)},i.stop=function(){var b=i.html();return null===b?!1:(i._event&&(k.detachEvent(b,"DOMNodeInserted",i._event),i._event=null),void (i._observer&&(i._observer.disconnect(),i._observer=null)))},i.connect=function(b){return i._event||i._observer?!1:void (i.observer(b)||i.events(b))},g.exports=i},{"./dom.js":8,"./utils":30}],22:[function(j,i,p){var o=j("./utils.js"),n=j("./urlparse.js"),m=j("./comms.js"),l=j("conf"),k={started:!1};k.connect=function(f,e){var h=n.getDomain(document.location.toString());if(!e&&l.PAGE_PROGRESS_DOMAINS&&!o.contains(l.PAGE_PROGRESS_DOMAINS,h)){return !1}if(k.started){return !1}k.started=!0;var g=function(){f.get("xcomm.page.progress",function(){f.notify("xcomm.page.progress.started")})};m.started?g():(m.connect(f,{name:"platform"}),f.one("xcomm.ready",g))},i.exports=k},{"./comms.js":7,"./urlparse.js":29,"./utils.js":30,conf:"d0R7L1"}],23:[function(i,h,n){function m(b){return function(){var a={method:b},e=Array.prototype.slice.call(arguments);/^get/.test(b)?(l.assert(e.length>0,"Get methods require a callback."),e.unshift(a)):(/^set/.test(b)&&(l.assert(0!==e.length,"Set methods require a value."),a.value=e[0]),e=[a]),this.send.apply(this,e)}}var l=i("./utils.js"),k=i("./browser.js"),j={};j.CONTEXT="player.js",j.VERSION="0.0.11",j.bound=function(f,e){return function(a){f.call(e||window,a.value)}},j.Player=function(b){return this instanceof j.Player?void this.init(b):new j.Player(b)},j.EVENTS={READY:"ready",PLAY:"play",PAUSE:"pause",ENDED:"ended",TIMEUPDATE:"timeupdate",PROGRESS:"progress",ERROR:"error"},j.EVENTS.all=function(){return l.map(j.EVENTS,function(b){return b})},j.METHODS={PLAY:"play",PAUSE:"pause",GETPAUSED:"getPaused",MUTE:"mute",UNMUTE:"unmute",GETMUTED:"getMuted",SETVOLUME:"setVolume",GETVOLUME:"getVolume",GETDURATION:"getDuration",SETCURRENTTIME:"setCurrentTime",GETCURRENTTIME:"getCurrentTime",SETLOOP:"setLoop",GETLOOP:"getLoop",REMOVEEVENTLISTENER:"removeEventListener",ADDEVENTLISTENER:"addEventListener"},j.METHODS.all=function(){return l.map(j.METHODS,function(b){return b})},j.READIED=[],j.Player.prototype.init=function(b){this.frame=b,this.url=b.url,this.events=j.EVENTS.all(),this.methods=j.METHODS.all()},j.Player.prototype.send=function(f,e,g){return f.context=j.CONTEXT,f.version=j.VERSION,e?(f.listener="l"+l.getUUID(),this.frame.one({event:f.method,listener:f.listener},j.bound(e,g),g)):this.frame.on(f.method,e,g),this.frame.send(f.method,f),!0},j.Player.prototype.on=function(g,e,q){var p=l.getUUID(),o={event:g,listener:p};return"ready"===g?this.frame.one(o,j.bound(e,q),q):this.frame.on(o,j.bound(e,q),q),this.frame.send("addEventListener",{event:"addEventListener",value:g,listener:p,context:j.CONTEXT,version:j.VERSION}),!0},j.Player.prototype.off=function(f){var e=this.frame.__hub.listeners(f);if(k.console.log("Player.off",e),e.length>0){for(var g in e){this.send({method:"removeEventListener",value:f,listener:e[g]}),this.frame.__hub.off([f,e[g]].join("."))}}return !1},j.Player.prototype.supports=function(f,e){l.assert(l.indexOf(["method","event"],f)>-1,'evtOrMethod needs to be either "event" or "method" got '+f),e=l.isArray(e)?e:[e];for(var o="event"===f?this.events:this.methods,g=0;g<e.length;g++){if(-1===j.indexOf(o,e[g])){return !1}}return !0},l.each(j.METHODS.all(),function(b){j.Player.prototype.hasOwnProperty(b)||(j.Player.prototype[b]=m(b))}),j._all=[],j.get=function(f,e,o){var g=function(q,p){return function(b,a){return q&&a!==q?!1:void p.call(window,b,q)}}(e,o);l.each(j._all,function(b){g(b.player,b.elem)}),f.on("media.player",g)},j.add=function(f,e){var g=new j.Player(e);f.notify("media.player",g,e.elem),j._all.push({player:g,elem:e.elem})},j.connect=function(b){b.on("media.player.init",function(a){j.add(b,a)}),b.on("card.player.ready",function(a){j.add(b,a)})},h.exports=j},{"./browser.js":5,"./utils.js":30}],24:[function(i,h,n){var m=i("./utils.js"),l=i("./browser.js"),k=i("./dom.js"),j=function(){this.init()};j.prototype.init=function(){var b=this;document.addEventListener?document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),b.ready()},!1):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),b.ready())}),document.documentElement.doScroll&&window===window.top&&!function(){if(!b.isReady){try{document.documentElement.doScroll("left")}catch(a){return void setTimeout(arguments.callee,0)}b.ready()}}()),k.addEvent(window,"load",b.ready)},j.prototype.ready=function(){return this.isReady?!1:(this.isReady=!1,void (this.callback&&this.callback()))},j.prototype.bind=function(b){this.isReady&&b(),this.callback=b},j.prototype.elem=function(g,f,q){var p=!1,o=function(){p===!1&&(p=!0,f.call(q))};return g.onload=o,k.addEvent(g,"load",o),g.onreadystatechange=function(){var a=g.readyState;("loaded"===a||"complete"===a)&&(g.onreadystatechange=null,o())},o},j.prototype.firstNode=function(){var f=document.getElementsByTagName("head")[0],e=k.child(f,"link");if(e){return e}var o=k.child(f,"style");if(o){return o}var g=k.child(f,"script");return g?g:null},j.prototype.appendToHead=function(f){var e=this.firstNode();if(null===e){var g=document.getElementsByTagName("head")[0];g?g.appendChild(f):document.body.appendChild(f)}else{e.parentNode.insertBefore(f,e)}},j.prototype.script=function(o,g,r,q){var p=document.createElement("script");return p.type="text/javascript",p.src=o,m.isNone(q)||m.each(q,function(f,e){p.setAttribute(e,f)}),this.elem(p,g,r),this.appendToHead(p),p},j.prototype.css=function(g,e,q){var p=document.createElement("link");p.type="text/css",p.rel="stylesheet",p.href=g;var o=this.elem(p,e,q);this.appendToHead(p),l.isPhantom()&&o()},h.exports=new j},{"./browser.js":5,"./dom.js":8,"./utils.js":30}],25:[function(h,g,l){var k=h("../urlparse.js"),j=h("../utils.js"),i={enabled:!1,defaults:{},options:{},_queue:{}};i.queue=function(f,e,m){e?e.send(f):i._queue.hasOwnProperty(m)?i._queue[m].push(f):i._queue[m]=[f]},i.add=function(f,e){var n=k.getQuery(f.elem.src);if(i.enabled){var m={key:n.key,media:n.url,url:document.location.toString()};i.options.hasOwnProperty(f.elem)&&(m=j.extend(m,i.options[f.elem])),m=j.extend(m,i.defaults),f.send("media.recommend",m),f.on("media.recommend.shown",function(a){e.notify("recommend.shown",f.elem,a)}),i._queue.hasOwnProperty(f.elem)&&(j.each(i._queue[f.elem],function(a){f.send(a)}),delete i._queue[f.elem])}},i.connect=function(b){b.on("media.recommend.options",function(a,f,e){i.enabled=!0,null===a?i.defaults=f:j.isElement(a)&&(i.options[a]=f),j.each(e,function(m){b.notify("media.recommend.add",m)})}),b.on("media.recommend.add",function(a){i.add(a,b)}),b.on("media.recommend.show",function(f,e){i.queue("media.recommend.show",f,e)}),b.on("media.recommend.destroy",function(f,e){i.queue("media.recommend.destroy",f,e)}),b.on("media.recommend.resize",function(u,t){if(!t.height){return !1}var s=u.parentNode,r=window.getComputedStyle(s),q=window.getComputedStyle(u),p=["relative"===r.position,r.paddingBottom===r.height||r.paddingTop===r.height,"absolute"===q.position];if(j.every(p)){var o=parseInt(q.width,10),n=(t.height/o*100).toPrecision(8)+"%",m=parseInt(r.paddingTop,10),e=parseInt(r.paddingBottom,10);m>e?s.style.paddingTop=n:s.style.paddingBottom=n}else{u.style.maxHeight="none",u.height=t.height,u.style.height=t.height.toString()+"px"}})},g.exports=i},{"../urlparse.js":29,"../utils.js":30}],26:[function(t,s,r){var q=t("./utils.js"),p=t("./dom.js"),o=t("./ready.js"),n=t("./urlparse.js"),m=t("./log/front.js"),l=t("conf"),k={_css:!1,hub:null};k.connect=function(b){k.hub=b},k.log=function(f,e){k.hub.notify("log.event",{u:f,g:"card",a:"click",c:e,l:q.hash(m.sid)})},k.url=function(f){var e=["e",q.hash(f),q.hash(m.sid)].join(".");return n.addHash(document.URL,e)},k.buttons=function(f){var e,g=p.create("div",{"class":"embdscl0"});return q.each(["facebook","twitter","pinterest","card","embedly"],function(a){e=p.create("a",{"class":"embd-"+a}),e.innerHTML="<i></i>",k.buttons[a].call(window,e,f)===!0&&g.appendChild(e)}),g},k.buttons.twitter=function(g,e){var w=e.options.url,v=e.extract.title,u=e.options.twitter_via,j={url:k.url(w)};return v&&(j.text=q.truncate(v,100)),u?j.via="@"===u.substr(0,1)?u.substr(1):u:j.via="embedly",g.href="https://twitter.com/intent/tweet?"+n.createQuery(j),p.addEvent(g,"click",function(b){var a=p.event(b);a.stop(),window.open(g.href,"_blank","width=550,height=410,top=150,left=150"),k.log(e.options.url,"twitter")}),!0},k.buttons.facebook=function(f,e){var g={u:k.url(e.options.url)};return f.href="https://www.facebook.com/sharer/sharer.php?"+n.createQuery(g),p.addEvent(f,"click",function(b){var a=p.event(b);a.stop(),window.open(f.href,"_blank","width=700,height=425,top=150,left=150"),k.log(e.options.url,"facebook")}),!0},k.buttons.pinterest=function(f,e){var h,g="https://www.pinterest.com/pin/create/button/";if(e.options.image){h=e.options.image}else{if(e.extract.media&&"photo"===e.extract.media.type){h=e.extract.media.url}else{if(!(e.extract.images&&e.extract.images.length>0)){return !1}h=e.extract.images[0].url}}return f.href=n.appendQuery(g,{url:k.url(e.options.url),media:h,description:e.extract.title}),p.addEvent(f,"click",function(b){var a=p.event(b);a.stop(),window.open(f.href,"_blank","width=700,height=425,top=150,left=150"),k.log(e.options.url,"pinterest")}),!0},k.buttons.card=function(f,e){return p.addEvent(f,"click",function(b){var h=p.event(b);h.stop();var g={url:e.options.url};q.each(["image","embed","title","description","lang"],function(i){e.options.hasOwnProperty(i)&&(g[i]=e.options[i])}),e.__hub.notify("card.repeat",g),k.log(e.options.url,"repeat")}),!0},k.buttons.embedly=function(f,e){var g={utm_source:n.getDomain(document.URL),utm_medium:"referral",utm_campaign:"cards"};return f.href=n.appendQuery("http://embed.ly/cards",g),f.target="_blank",p.addEvent(f,"click",function(){k.log(e.options.url,"whats-this")}),!0},k.css=function(f){if(!k._css){k._css=!0;var e=l.EMB_ORIGIN_BASE+"css/social."+l.EMB_ASSET_VERSION+".css";return o.css(e,f),!1}f()},k.card=function(f){var e=f.elem.parentNode;return !q.isElement(e)||"DIV"!==e.nodeName&&!p.hasClass(e,"embedly-card")?!1:void k.css(function(){var a=k.buttons(f);p.addEvent(e,"mouseenter",function(){p.addClass(a,"embd-active")}),p.addEvent(e,"mouseleave",function(){p.removeClass(a,"embd-active")}),e.appendChild(a),f.__hub.notify("card.share.init")})},s.exports=k},{"./dom.js":8,"./log/front.js":19,"./ready.js":24,"./urlparse.js":29,"./utils.js":30,conf:"d0R7L1"}],27:[function(i,h,n){var m=i("./utils.js"),l=i("./urlparse.js"),k=i("conf"),j={};j.youtube={schema:"youtube",re:/youtube\.com\/embed\/([^\/?#]+)/i,url:function(f){var e=j.youtube.re.exec(f);return 2!==e.length?f:"http://www.youtube.com/watch?v="+e[1]}},j.vimeo={schema:"vimeo",re:/player\.vimeo\.com\/video\/([^\/?#]+)/i,url:function(f){var e=j.vimeo.re.exec(f);return 2!==e.length?f:"http://vimeo.com/"+e[1]}},j.soundcloud={schema:"soundcloud",re:/w\.soundcloud\.com\/player\/\?/,url:function(f){var e=l.getQuery(f);if(e.url){var g=/api\.soundcloud\.com\/tracks\/([^\/?#]+)/.exec(e.url);if(2===g.length){return"https://soundcloud.com/track/"+g[1]}}return f}},j.providers=[j.youtube,j.vimeo,j.soundcloud],j.provider=function(b){return m.reduce(j.providers,function(a,e){return e.re.test(b)?e:a},null)},j.replace=function(g,e){if(m.isNone(g)||!m.isElement(g)){return null}if("IFRAME"!==g.nodeName){return null}if(!g.src||!m.isString(g.src)){return null}if(!e.key){return !1}var s=g.src;s=s.replace(/&amp;/g,"&");var r=j.provider(s);if(null===r){return null}var q="https:"===window.location.protocol?"https:":"http:";"file://"===s.substr(0,7)&&(s=s.substr(5)),"//"===s.substr(0,2)&&(s=q+s);var p=m.extend({},e,{url:r.url(s),src:s,schema:r.schema,type:"text/html"}),o=q+"//cdn.embedly.com/widgets/";k.EMB_DEBUG&&(o=k.EMB_FRAME_SRC);var f=o+"media.html?"+l.createQuery(p);return g.src=f,g},h.exports=j},{"./urlparse.js":29,"./utils.js":30,conf:"d0R7L1"}],28:[function(g,f,j){var i=g("./utils.js"),h={};h.Tunnel=function(b){this.init(b)},h.Tunnel.prototype.init=function(b){this.parent=b,this.child=null,this.ready=!1,this.queue=[]},h.Tunnel.prototype.connect=function(b){this.child=b,this.child.on("receiver.send",i.bind(function(k,e){i.isNone(e)&&(e={}),e.method=k,setTimeout(i.bind(function(){this.parent.notify("message",e)},this),1)},this)),this.ready=!0,this.release()},h.Tunnel.prototype.release=function(){for(var b=0;b<this.queue.length;b++){this.send(this.queue[b])}this.queue=[]},h.Tunnel.prototype.send=function(b){return this.ready?void setTimeout(i.bind(function(){this.child.notify(b.method,b)},this),1):(this.queue.push(b),!1)},h.Tunnel.prototype.clear=function(){this.ready=!1,this.parent.clear(),this.child&&this.child.clear()},f.exports=h},{"./utils.js":30}],29:[function(g,f,j){var i=g("./utils.js"),h={};h.createQuery=function(k){var e=[],l="";return k&&i.isObject(k)&&!i.isEmptyObject(k)?(i.each(k,function(b,m){e.push(encodeURIComponent(m)+"="+encodeURIComponent(b))}),e.sort(),e.join("&")):l},h.parseQuery=function(k){var e={};if(!k||!i.isString(k)){return e}("#"===k.substr(0,1)||"?"===k.substr(0,1))&&(k=k.substr(1));var l=k.split("&");return i.each(l,function(b){if(!b){return !0}var n=b.split("="),m=decodeURIComponent(n[0]);1===n.length?e[m]="":2===n.length?e[m]=decodeURIComponent(n[1]):e[m]=decodeURIComponent(n.slice(1).join("="))}),e},h.getQuery=function(k){if(!k||!i.isString(k)){return{}}var e=k.split("?");return 2===e.length?h.parseQuery(e[1]):e.length>2?h.parseQuery(e.slice(1).join("?")):{}},h.appendQuery=function(k,e){if(!k||!i.isString(k)){return null}var n=k.split("?"),m=n[0];if(!e||!i.isObject(e)||i.isEmptyObject(e)){return k}var l=h.getQuery(k);return l=i.extend(l,e),i.isEmptyObject(l)?k:[m,h.createQuery(l)].join("?")},h.removeQuery=function(k,e){if(!k||!i.isString(k)){return null}var n=k.split("?"),m=n[0],l=h.getQuery(k);return l.hasOwnProperty(e)&&delete l[e],i.isEmptyObject(l)?m:[m,h.createQuery(l)].join("?")},h.getOrigin=function(k){if(!k||!i.isString(k)){return null}if(!/^https?:\/\//.test(k)){return null}var e=k.split("/").slice(0,3).join("/");return -1===e.indexOf(".")?null:e},h.getDomain=function(k){var e=h.getOrigin(k);return e?e.replace(/^https?:\/\//,""):null},h.param=function(b){return i.map(b,function(k,e){return encodeURIComponent(e)+"="+encodeURIComponent(k)}).join("&")},h.Parsed=function(k,e){this.init(k,e)},h.Parsed.prototype.init=function(k,e){this.original=k,this.url=e,this._valid=!1,this.url=e},h.Parsed.prototype.valid=function(b){return(b===!0||b===!1)&&(this._valid=b),this._valid},h.parse=function(k){var e=k,m="https:"===window.location.protocol?"https:":"http:";k=k?i.trim(k):k;var l=new h.Parsed(e,k);return k?/^https?:\/\/[^\/]+\.[^\/]/i.test(k)?(l.valid(!0),l):/^\w+:/i.test(k)?l:"#"===k[0]?l:/^\/\/[^\/]+\.[^\/]/i.test(k)?(l.valid(!0),l.url=m+k,l):/^\/([^\/]+|$)/i.test(k)?(l.valid(!0),l.url=h.getOrigin(window.location.toString())+k,l):/^[^\/]+\.[^\/]/i.test(k)?(l.valid(!0),l.url="http://"+k,l):l:l},h.addHash=function(k,e){return -1===k.indexOf("#")?k+"#"+e:k+"&"+e},f.exports=h},{"./utils.js":30}],30:[function(H,G,F){var E=H("conf"),D={},C={},B=Array.prototype,A=Object.prototype,z=Function.prototype,y=B.slice,x=A.toString,w=B.forEach,v=B.reduce,u=B.every,t=B.indexOf,s=z.bind;D.identity=function(b){return b},D.each=function(h,f,l){if(null!=h){if(w&&h.forEach===w){h.forEach(f,l)}else{if(h.length===+h.length){for(var k=0,j=h.length;j>k;k++){if(k in h&&f.call(l,h[k],k,h)===C){return}}}else{for(var i in h){if(A.hasOwnProperty.call(h,i)&&f.call(l,h[i],i,h)===C){return}}}}}},D.map=function(f,e,h){var g=[];return null==f?g:Array.prototype.map&&f.map===Array.prototype.map?f.map(e,h):(D.each(f,function(b,j,i){g[g.length]=e.call(h,b,j,i)}),g)},D.reduce=function(g,e,j,i){var h=arguments.length>2;if(null==g&&(g=[]),v&&g.reduce===v){return i&&(e=D.bind(e,i)),h?g.reduce(e,j):g.reduce(e)}if(D.each(g,function(b,k,f){h?j=e.call(i,j,b,k,f):(j=b,h=!0)}),!h){throw new TypeError("Reduce of empty array with no initial value")}return j},D.zip=function(b){return D.map(b[0],function(a,e){return a.map(b,function(f){return f[e]})})},D.extend=function(b){return D.each(Array.prototype.slice.call(arguments,1),function(a){for(var e in a){void 0!==a[e]&&(b[e]=a[e])}}),b},D.contains=function(f,e){if(!t){for(var h=0,g=f.length;g>h;h++){if(f[h]===e){return !0}}return !1}return f.indexOf(e)>-1},D.every=function(f,e,h){e||(e=D.identity);var g=!0;return null==f?g:u&&f.every===u?f.every(e,h):(D.each(f,function(b,j,i){return(g=g&&e.call(h,b,j,i))?void 0:C}),!!g)},D.indexOf=function(f,e){if(null==f){return -1}var h=0,g=f.length;if(t&&f.indexOf===t){return f.indexOf(e)}for(;g>h;h++){if(f[h]===e){return h}}return -1},D.batch=function(f,e){var h=[],g=[];return D.each(f,function(b){g.push(b),g.length===e&&(h.push(g),g=[])}),0!==g.length&&h.push(g),h};var r=function(){};D.bind=function(f,e){var h,g;if(s&&f.bind===s){return s.apply(f,y.call(arguments,1))}if(!D.isFunction(f)){throw new TypeError}return h=y.call(arguments,2),g=function(){if(!(this instanceof g)){return f.apply(e,h.concat(y.call(arguments)))}r.prototype=f.prototype;var b=new r;r.prototype=null;var a=f.apply(b,h.concat(y.call(arguments)));return Object(a)===a?a:b}},D.get=function(g,e,j){if(j=D.isNone(j)?null:j,D.isNone(e)||!D.isString(e)||!g){return j}if(""===e){return g}var i=e.split("."),h=i.splice(0,1)[0];return g.hasOwnProperty(h)?D.get(g[h],i.join("."),j):j},D.isFunction=function(f){try{return/^\s*\bfunction\b/.test(f)}catch(e){return !1}},D.isNone=function(b){return null===b||"undefined"==typeof b},D.isString=function(b){return"[object String]"===x.call(b)},D.isNumber=function(b){return"[object Number]"===x.call(b)},D.isDate=function(b){return"[object Date]"===x.call(b)},D.isObject=function(b){return"[object Object]"===x.call(b)},D.isArray=function(b){return"[object Array]"===x.call(b)},D.isElement=function(b){return !D.isNone(b)&&!D.isNone(b.nodeType)&&1===b.nodeType},D.isEmptyObject=function(f){if(D.isObject(f)){for(var e in f){if(A.hasOwnProperty.call(f,e)){return !1}}return !0}return !1},D.bool=function(b){return D.isNone(b)?null:"true"===b||"yes"===b||"1"===b||1===b||b===!0?!0:"false"===b||"no"===b||"0"===b||0===b||b===!1?!1:null},D.assert=function(f,e){if(!f){throw e||"Assertion Failed"}},D.getUUID=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(f){var e=16*Math.random()|0,g="x"===f?e:3&e|8;return g.toString(16)})},D.getTimestamp=function(){var b=new Date;return b.getTime()},D.trim=function(b){return b.replace(/^\s+|\s+$/g,"")},D.capitalize=function(b){return b.charAt(0).toUpperCase()+b.substr(1)},D.camelCase=function(f,e){var g=f.split("-");return e=e?e:g.length,g.length>1&&(f=g.splice(0,1)[0],f+=D.map(g.splice(0,e),function(b){return b[0].toUpperCase()+b.substr(1)}).join(""),g.length>0&&(f+="-"+g.join("-"))),f},D.truncate=function(f,e){return f?(e=e?e:50,f.length<e?f:(f=f.substr(0,e-3),D.trim(f)+"...")):""},D.fmt=function(f,e){return f.replace(/{(\w+)}/g,function(b,g){return e[g]?e[g]:""})},D.hash=function(g){var f,j,i,h=0;if(0===g.length){return h}for(f=0,i=g.length;i>f;f++){j=g.charCodeAt(f),h=(h<<5)-h+j,h|=0}return h="0000000"+Math.abs(h).toString(32),h.substr(h.length-6)},D.rgbToHex=function(f,e,g){return"#"+((1<<24)+(f<<16)+(e<<8)+g).toString(16).slice(1)},E.EMB_DEBUG===!0&&(window._=D),G.exports=D},{conf:"d0R7L1"}],31:[function(i,h,n){var m=i("./utils.js"),l=i("./dom.js"),k=i("./browser.js"),j=function(){this.init()};j.prototype.init=function(){this._elements=[],this._listening=!1},j.prototype.viewable=function(f){if(!f.getBoundingClientRect){return !0}var e;try{e=f.getBoundingClientRect()}catch(g){return !1}return e.bottom>=0&&e.right>=0&&e.top<=(window.innerHeight||document.documentElement.clientHeight)&&e.left<=(window.innerWidth||document.documentElement.clientWidth)},j.prototype.check=function(){this.freeze=!0;var b=[];m.each(this._elements,m.bind(function(a,f){if(this.viewable(a.elem)){try{a.func.call(this)}catch(e){k.console.log(e)}b.push(f)}},this)),m.each(b,function(e){this._elements.splice(e,1)},this),0===this._elements.length&&this.stop(),this.freeze=!1},j.prototype.stop=function(){try{l.detachEvent(window,"DOMContentLoaded",this.handler),l.detachEvent(window,"load",this.handler),l.detachEvent(window,"resize",this.handler),l.detachEvent(window,"scroll",this.handler)}catch(b){}this.handler=null,this._listening=!1},j.prototype.listen=function(){return this._listening?!1:(this._listening=!0,this.handler=m.bind(function(){!this.freeze&&this._elements.length&&this.check()},this),l.addEvent(window,"DOMContentLoaded",this.handler),l.addEvent(window,"load",this.handler),l.addEvent(window,"resize",this.handler),void l.addEvent(window,"scroll",this.handler))},j.prototype.on=function(f,e,g){"viewable"===f&&(this._elements.push({elem:e,func:g}),this.listen(),this.check())},h.exports=j},{"./browser.js":5,"./dom.js":8,"./utils.js":30}],32:[function(aC,aB,aA){if(window.embedly&&window.embedly.look){return window.embedly.look(),!1}var az=aC("./common/iframes/all.js"),ay=aC("./common/browser.js"),ax=aC("./common/utils.js"),aw=aC("./common/a.js"),av=aC("./common/dom.js"),au=aC("./common/ready.js"),at=aC("./common/meta.js"),ar=aC("./common/viewport.js"),aq=aC("./common/page.js"),ap=aC("./common/urlparse.js"),ao=aC("./common/found.js"),an=aC("./common/share.js"),am=aC("./common/log/front.js"),al=aC("./common/recommend/front.js"),ak=aC("./common/players.js"),aj=aC("./common/integrate.js"),ai=new aw,ah=new ar;al.connect(ai),an.connect(ai),ak.connect(ai),aj.connect(ai),am.connect(ai,"platform");var ag=function(){var b=/emb_(\d+)/.exec(ay.location.hash());return b?b[1]:null},af={analytics:null,recommend:!1,shared:ag(),defaults:{cards:{}}},ae={media:[]},ad=function(f){var e;try{e=JSON.parse(f.data)}catch(g){return ay.console.error(g),!1}ai.notify("window.message",f,e)};av.addEvent(window,"message",ad);var ac=function(h,f,k){var j;if(ax.isFunction(f)&&(k=f,f={}),ax.isString(h)||!ax.isElement(h)&&ax.isObject(h)){return ao.add.cards(h),!0}if(ax.isElement(h)&&("a"===h.nodeName.toLowerCase()||"blockquote"===h.nodeName.toLowerCase())){var i=ax.extend({},af.defaults.cards,f);j=az.cards.one(h,i,ai,function(b){ax.isFunction(k)&&k.call(b,b)})}return j},ab=function(f){var e;return ax.isString(f)?(ao.add.button(f),!0):(ax.isElement(f)&&"a"===f.nodeName.toLowerCase()&&(e=az.button.one(f,ai)),e&&e.on("button.rendered",function(){ai.notify("button.rendered",e.elem,e)}),e)},aa=function(g,f){var i;i=ax.isString(g)?{url:g}:g;var h=az.modal.one(i,ai);return ax.isFunction(f)&&f.call(h,h),h},Z=function(g,f,i){var h=az.slideshow.one(g,f,ai);return ax.isFunction(i)&&i.call(h,h),h},Y=function(f){if("1"===av.data(f,"connected")){return !1}av.data(f,"connected","1");var e=az.connect(null,f,ai);e.one("media.ready",function(b){e.url=b.url,e.ready(),ah.on("viewable",e.elem,function(){e.send("media.view")}),ai.notify("media.recommend.add",e),ae.media.push(e),b.controllable&&ai.notify("media.player.init",e),ai.notify("media.ready",e)}),e.on("media.recommend.resize",function(a){ai.notify("media.recommend.resize",f,a)}),e.send("media.ready",{},!0)},X=function(b){return b&&b.key?(ao.analytics=b,void ao.look()):!1},W=function(f,e){if(!ax.isElement(f)){return !1}if(ax.isString(e)){var g=!1;ax.each(ae.media,function(a){a.elem===f&&(g=!0,ai.notify("media.recommend."+e,a,a.elem))}),g||ai.notify("media.recommend."+e,null,f)}else{ax.isObject(e)&&ai.notify("media.recommend.options",f,e,ae.media)}ao.look()},V=function(b){return ax.isString(b)&&"reset"===b?(af.defaults.cards={},!1):ax.isObject(b)?(b.hasOwnProperty("cards")&&ax.isObject(b.cards)&&(af.defaults.cards=ax.extend({},af.defaults.cards,b.cards)),b.hasOwnProperty("recommend")&&(ai.notify("media.recommend.options",null,b.recommend,ae.media),ax.each(ae.media,function(e){ai.notify("media.recommend.add",e)})),void (b.hasOwnProperty("integrations")&&aj.configure(b.integrations))):!1},U=function(f,e){ax.isFunction(f)&&(e=f,f=null),ak.get(ai,f,e)};ai.on("found",function(b){b.cards&&b.cards.length&&az.cards.multi(b.cards,af.defaults.cards,ai),b.buttons&&b.buttons.length&&ax.each(b.buttons,function(e){ab(e)}),b.slideshows&&b.slideshows.length&&ax.each(b.slideshows,function(e){Z(e)}),b.iframes&&b.iframes.length&&ax.each(b.iframes,function(e){Y(e)})}),ai.on("modal.create",function(b){aa(b)}),ai.on("media.ready",function(b){at.send("media.meta",b)}),ai.on("card.rendered",function(f,e){at.send("card.meta",e),ah.on("viewable",f,ax.bind(function(){this.send("card.view")},e))}),ai.on("card.rendered",function(f,e){if(!af.shared){return !1}if(!e.query||!e.query.url){return !1}var g=ax.hash(e.query.url);return g!==af.shared?!1:(af.shared=null,void setTimeout(function(){var b=av.rect(e.elem);return b&&b.top?void ay.animateScroll(b.top-5,500):!1},500))});var T=!1;ai.on("pinterest.log",function(){if(T){return !1}T=!0;var b={type:"pidget",partner:"embedly",via:document.URL,callback:ax.getUUID()};au.script("https://log.pinterest.com/?"+ap.createQuery(b),function(){av.remove(av.one("#pinLog"))},this,{id:"pinLog"})});var S=function(f,e){ai.on(f,e)},R=function(f,e){ai.off(f,e)},Q=function(){av.detachEvent(window,"message",ad),ao.stop(),ai.clear(),av.remove(av.one("#emb_xcomm")),window.embedly=null},P=function(){var f=Array.prototype.slice.call(arguments,0);if(0===f.length){return null}var e=f.splice(0,1)[0];switch(e){case"card":return ac.apply(window,f);case"button":return ab.apply(window,f);case"modal":return aa.apply(window,f);case"slideshow":return Z.apply(window,f);case"look":return ao.look.apply(window,f);case"on":return S.apply(window,f);case"off":return R.apply(window,f);case"kill":return Q.apply(window,f);case"analytics":return X.apply(window,f);case"player":return U.apply(window,f);case"recommend":return W.apply(window,f);case"defaults":return V.apply(window,f)}return null},O=[];window.embedly&&ax.isFunction(window.embedly)&&ax.isArray(window.embedly.q)&&(O=window.embedly.q),window.embedly=function(){return P.apply(window,arguments)},window.embedly.card=function(){return ac.apply(window,arguments)},window.embedly.button=function(){return ab.apply(window,arguments)},window.embedly.modal=function(){return aa.apply(window,arguments)},window.embedly.slideshow=function(){return Z.apply(window,arguments)},window.embedly.look=function(){return ao.look()},window.embedly.defaults=function(){return V.apply(window,arguments)},ax.each(O,function(b){window.embedly.apply(window,b)}),aq.connect(ai),ao.connect(ai),au.bind(ao.look),ax.isFunction(window.onEmbedlyReady)&&window.onEmbedlyReady.apply(this,[window.embedly])},{"./common/a.js":3,"./common/browser.js":5,"./common/dom.js":8,"./common/found.js":9,"./common/iframes/all.js":10,"./common/integrate.js":17,"./common/log/front.js":19,"./common/meta.js":20,"./common/page.js":22,"./common/players.js":23,"./common/ready.js":24,"./common/recommend/front.js":25,"./common/share.js":26,"./common/urlparse.js":29,"./common/utils.js":30,"./common/viewport.js":31}]},{},[32])}();